(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    105287,       2184]
NotebookOptionsPosition[    103790,       2157]
NotebookOutlinePosition[    104128,       2172]
CellTagsIndexPosition[    104085,       2169]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"<<", "ToMatlab`"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.791046249034791*^9, 3.7910462745701647`*^9}, {
   3.791046342091267*^9, 3.791046456029419*^9}, {3.791046517627427*^9, 
   3.791046535890912*^9}, {3.791046661479453*^9, 3.7910466627099323`*^9}, {
   3.791046712008885*^9, 3.791046838914184*^9}, {3.791046946127902*^9, 
   3.791046955391603*^9}, {3.791047188965599*^9, 3.791047201690301*^9}, {
   3.791047341034197*^9, 3.79104757109272*^9}, {3.7910488608510447`*^9, 
   3.791048882954791*^9}, {3.791048925202257*^9, 3.791048932677668*^9}, {
   3.79104900453306*^9, 3.791049064029978*^9}, {3.791049284108379*^9, 
   3.7910493345155973`*^9}, {3.79104937588171*^9, 3.79104942105298*^9}, {
   3.7910495165057087`*^9, 3.791049565031843*^9}, {3.791050036325591*^9, 
   3.791050055155387*^9}, {3.791123623637176*^9, 3.791123624640842*^9}, {
   3.79120960904136*^9, 3.7912096544249287`*^9}, {3.7912097294331617`*^9, 
   3.791209730720068*^9}, {3.791209771055937*^9, 3.791209771224588*^9}, {
   3.791209825368104*^9, 3.791209862499053*^9}, {3.791209893613626*^9, 
   3.791209951354701*^9}, {3.791216136655933*^9, 3.791216170115103*^9}, {
   3.791216221738364*^9, 3.7912162665174713`*^9}, {3.791216299378374*^9, 
   3.79121632012533*^9}, {3.791216365463752*^9, 3.791216391212566*^9}, {
   3.791216445347967*^9, 3.7912164461459208`*^9}, {3.791216635860551*^9, 
   3.791216708120322*^9}, {3.791216760790188*^9, 3.791216767864616*^9}, {
   3.79121680992824*^9, 3.791216845170759*^9}, 3.79121687762529*^9, {
   3.791217217605546*^9, 3.7912172218909893`*^9}, {3.7912172664176407`*^9, 
   3.791217298865902*^9}, {3.791217352660488*^9, 3.791217375209235*^9}, {
   3.791218159588902*^9, 3.791218162602737*^9}, {3.7912183053609867`*^9, 
   3.791218306363585*^9}, {3.791218646315565*^9, 3.79121869344265*^9}, {
   3.791220126802896*^9, 3.791220156400066*^9}, {3.791220285373622*^9, 
   3.79122029005354*^9}, {3.791221358933098*^9, 3.791221371402417*^9}, {
   3.7912218364015417`*^9, 3.791221840822266*^9}, 3.791222267852975*^9, {
   3.791222461862306*^9, 3.791222469782576*^9}, {3.791222534538028*^9, 
   3.7912225369352913`*^9}, {3.7912880841315327`*^9, 3.7912880923302603`*^9}, 
   3.7941695449881277`*^9, {3.7948628980236607`*^9, 3.794862930154006*^9}, {
   3.794862988577829*^9, 3.794862988875266*^9}, {3.7948630245394793`*^9, 
   3.794863025621635*^9}, {3.7948640196573963`*^9, 3.794864054775683*^9}, {
   3.7948680282993727`*^9, 3.7948680316371593`*^9}, {3.794868315554142*^9, 
   3.794868316666201*^9}, {3.7948685653028173`*^9, 3.794868568098201*^9}, {
   3.7948688531624603`*^9, 3.794868873134296*^9}, {3.794868953777638*^9, 
   3.794868955378693*^9}, {3.794869243300647*^9, 3.794869264983307*^9}, {
   3.794869617865423*^9, 3.7948696302892847`*^9}, {3.794869909634163*^9, 
   3.794869911745257*^9}, {3.7949219428575687`*^9, 3.7949219863733177`*^9}, {
   3.794922116305949*^9, 3.794922117106225*^9}, {3.794923884595536*^9, 
   3.794923884692504*^9}, {3.7949240199844027`*^9, 3.794924020291194*^9}, {
   3.794924065768695*^9, 3.794924067528352*^9}, {3.7949243968363857`*^9, 
   3.794924538287026*^9}, {3.794924702675165*^9, 3.794924725149262*^9}, {
   3.794924954143663*^9, 3.794924957219339*^9}, {3.7949252399012537`*^9, 
   3.794925296062491*^9}, {3.794925404877809*^9, 3.7949254069311*^9}, {
   3.794925500091611*^9, 3.794925501741569*^9}, {3.7949406662034492`*^9, 
   3.7949407888358507`*^9}, {3.794940861697424*^9, 3.794940861887937*^9}, {
   3.7949409813169947`*^9, 3.7949409840069857`*^9}, {3.794941354017476*^9, 
   3.7949413540863543`*^9}, {3.794948673605836*^9, 3.794948686153894*^9}, 
   3.794948751499473*^9, {3.79494880555661*^9, 3.794948805682559*^9}, {
   3.794949229211856*^9, 3.794949234338476*^9}, {3.794951657723711*^9, 
   3.794951770880986*^9}, {3.794952404072263*^9, 3.7949524310220137`*^9}, {
   3.794952470105896*^9, 3.794952470246545*^9}, {3.794952542179962*^9, 
   3.794952730932785*^9}, {3.794953068444368*^9, 3.794953110628261*^9}, {
   3.795869283916328*^9, 3.79586933369628*^9}, {3.795869671206867*^9, 
   3.795869671540806*^9}, {3.795869737255707*^9, 3.7958697377091703`*^9}, {
   3.7958700226215057`*^9, 3.795870068747086*^9}, {3.795870160228662*^9, 
   3.7958701912274427`*^9}, {3.795870356656062*^9, 3.795870387263233*^9}, {
   3.79587062556279*^9, 3.795870638380351*^9}, {3.795870674744177*^9, 
   3.79587067763383*^9}, {3.795870784093721*^9, 3.795870813524185*^9}, {
   3.795871301868997*^9, 3.795871323859858*^9}, {3.7958713753726273`*^9, 
   3.795871423942377*^9}, {3.795871663444737*^9, 3.7958716910269737`*^9}, {
   3.7958722279640713`*^9, 3.7958722337007504`*^9}, {3.7958725443783092`*^9, 
   3.795872615933139*^9}, {3.795872648078126*^9, 3.795872648327343*^9}, {
   3.7958735837710953`*^9, 3.795873589970358*^9}, {3.79589134593948*^9, 
   3.795891365530506*^9}, {3.795891409698213*^9, 3.795891410031828*^9}, {
   3.7958915235776577`*^9, 3.795891595960496*^9}, {3.7958917418596354`*^9, 
   3.79589174541674*^9}, {3.795892045164661*^9, 3.795892057495101*^9}, {
   3.795892496244615*^9, 3.795892528883204*^9}, {3.795893001356956*^9, 
   3.795893020973222*^9}, {3.795893053848816*^9, 3.795893070917057*^9}, {
   3.795893159171391*^9, 3.7958931592031183`*^9}, {3.795893381294548*^9, 
   3.795893388101112*^9}, {3.795893551581946*^9, 3.79589355778684*^9}, {
   3.7958936697085543`*^9, 3.795893689694845*^9}, {3.795894331714465*^9, 
   3.795894332637155*^9}, {3.795956125793376*^9, 3.795956125977522*^9}, {
   3.795956678558354*^9, 3.795956681964757*^9}, {3.79595671694168*^9, 
   3.795956740723609*^9}, {3.795956860220419*^9, 3.795956879434836*^9}, {
   3.795958063874341*^9, 3.795958081091507*^9}, {3.795958239379644*^9, 
   3.7959582439821863`*^9}, {3.795958346198765*^9, 3.7959583463848343`*^9}, {
   3.7959584867557993`*^9, 3.795958528596526*^9}, {3.795958715861845*^9, 
   3.7959587163488817`*^9}, {3.795960270628001*^9, 3.795960280753561*^9}, {
   3.79596313316469*^9, 3.7959632099556017`*^9}, {3.795967347440943*^9, 
   3.795967347630332*^9}, {3.795967474183544*^9, 3.7959674865126963`*^9}, {
   3.795967617988482*^9, 3.795967618967753*^9}, {3.795967894833398*^9, 
   3.7959679448469877`*^9}, {3.7959688415809097`*^9, 3.795968849921077*^9}, {
   3.795969465354463*^9, 3.795969468322399*^9}, {3.7960464593720427`*^9, 
   3.796046460331554*^9}, {3.796046528074419*^9, 3.796046534329262*^9}, {
   3.796050914610352*^9, 3.796050946032563*^9}, {3.796061758194716*^9, 
   3.79606176216336*^9}, {3.7960645050029173`*^9, 3.796064509014784*^9}, {
   3.796065367404907*^9, 3.796065378926017*^9}, {3.796134219682151*^9, 
   3.796134247640088*^9}, {3.7961348649891872`*^9, 3.796134865526979*^9}, {
   3.7961349640151663`*^9, 3.7961349682754087`*^9}, {3.79613514268791*^9, 
   3.796135142794756*^9}, {3.796135371897667*^9, 3.796135376249398*^9}, {
   3.796135662376257*^9, 3.796135666678493*^9}, {3.796136476837295*^9, 
   3.796136481188024*^9}, {3.796141972377802*^9, 3.79614197263267*^9}, {
   3.7961601083667603`*^9, 3.796160132477682*^9}, {3.797002971121592*^9, 
   3.797002972276581*^9}, {3.7971842863453293`*^9, 3.797184296643888*^9}, 
   3.797254710735221*^9, 3.797276206195918*^9, {3.797276328560773*^9, 
   3.797276342717699*^9}, {3.797276474589422*^9, 3.7972764781138906`*^9}, {
   3.797281720373191*^9, 3.797281768832017*^9}, 3.7972818146878147`*^9, {
   3.797282066350203*^9, 3.797282074458353*^9}, {3.7972821338573236`*^9, 
   3.797282135107806*^9}, {3.797282237751178*^9, 3.7972822383597383`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"31e5366b-cc42-472f-b3ec-a01bd110541e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Get", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<QBMMlib2.wl\>\""}], 
   "]"}], "*)"}]], "Input",
 CellChangeTimes->{
  3.545825155715281*^9, {3.797282531680509*^9, 3.797282534521785*^9}, {
   3.797282584672224*^9, 3.797282596152588*^9}, 
   3.797285110048308*^9},ExpressionUUID->"5358c7e2-7e38-471c-83ae-\
8ed81170c2db"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Cp", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.545825155715281*^9, {3.7972630535720587`*^9, 3.797263060057353*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"07b0e591-28cd-4bf4-965f-78d4aedbee84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"model", "=", "\"\<nonlinear\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"model", "\[Equal]", "\"\<linear\>\""}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"Ca", "=", 
      RowBox[{"1", "/", "2"}]}], ";", 
     RowBox[{"\[Gamma]", "=", "1"}], ";", 
     RowBox[{"Rey", "=", "Infinity"}], ";", "\n", "\t", 
     RowBox[{"Cp0", "=", "1"}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"Cp", "[", "t_", "]"}], ":=", "Cp0"}], ";", "\n", "\t", 
     RowBox[{"Toneperiod", "=", 
      RowBox[{"3.4", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "/", "Cp0"}], ")"}], "0.75"]}]}], ";"}]}], "\n", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"model", "\[Equal]", "\"\<nonlinear\>\""}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"Ca", "=", 
      RowBox[{"1", "/", "2"}]}], ";", 
     RowBox[{"\[Gamma]", "=", "1.4"}], ";", "\n", "\t", 
     RowBox[{"Cp0", "=", 
      RowBox[{"1", "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", "0.5"}], ")"}]}]}], ";", "\n", "\t", 
     RowBox[{"Toneperiod", "=", 
      RowBox[{"3.4", " ", "2", "  ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "/", "Cp0"}], ")"}], "0.75"]}]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"Cp", "[", "t_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "<", "Toneperiod"}], ",", 
        RowBox[{
         RowBox[{"Cp0", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"2", " ", "Pi", " ", 
            RowBox[{"t", "/", "Toneperiod"}]}], "]"}]}], "+", "1"}], ",", 
        "1"}], "]"}]}], ";"}]}], "\n", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Nperiod", "=", "20"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", 
    RowBox[{"Nperiod", " ", "Toneperiod"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt0", "=", 
   RowBox[{"1.", "  ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dt", "=", "dt0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtmin", "=", "dt"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtmax", "=", 
   RowBox[{"1000", "dt0"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tol", "=", 
    RowBox[{"1", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[Mu]R", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]R", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]Rd", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "14"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]Rd", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalD]r", "=", 
   RowBox[{"LogNormalDistribution", "[", 
    RowBox[{
     RowBox[{"Log", "[", "\[Mu]R", "]"}], ",", "\[Sigma]R"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalD]v", "=", 
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"\[Mu]Rd", ",", "\[Sigma]Rd"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RRdPDF", "=", 
    RowBox[{"ProductDistribution", "[", 
     RowBox[{"\[ScriptCapitalD]r", ",", "\[ScriptCapitalD]v"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RRdPDF", "=", 
     RowBox[{"BinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]R", ",", "\[Mu]Rd"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]R", ",", "\[Sigma]Rd"}], "}"}], ",", "0.5"}], 
      "]"}]}], ";"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"momRRd", "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
    RowBox[{"Moment", "[", 
     RowBox[{"RRdPDF", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nr", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nrd", "=", "nr"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"nr", "\[Equal]", "2"}], ",", 
    RowBox[{"ks", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"nr", "\[Equal]", "3"}], ",", 
     RowBox[{"ks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}]}], "]"}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ksp", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Gamma]"}], ")"}]}], ",", "0"}], "}"}]}], 
     "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"project", "[", 
     RowBox[{"xix_", ",", "xiy_", ",", "w_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"moms", ",", "mom", ",", "momsp"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"mom", "[", 
         RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"w", "[", 
            RowBox[{"[", "i", "]"}], "]"}], 
           SuperscriptBox[
            RowBox[{"xix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "p"], 
           SuperscriptBox[
            RowBox[{"xiy", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "q"]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"nr", " ", "nrd"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"moms", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"mom", "[", 
           RowBox[{
            RowBox[{"ks", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"ks", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"momsp", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"mom", "[", 
           RowBox[{
            RowBox[{"ksp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"ksp", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ksp", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"moms", ",", "momsp"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"hyqmom", "[", "momin_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"moms", "=", "momin"}], ",", "n", ",", "u", ",", "bu", ",", 
        "d2", ",", "c2", ",", "err", ",", "mo"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"u", "=", "n"}], ";", "\n", "\t", 
       RowBox[{"bu", "=", 
        RowBox[{
         RowBox[{"moms", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"moms", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"d2", "=", 
        RowBox[{
         RowBox[{"moms", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "/", 
         RowBox[{"moms", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"c2", "=", 
        RowBox[{"d2", "-", 
         SuperscriptBox["bu", "2"]}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"moms", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"moms", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"bu", "-", 
         RowBox[{"Sqrt", "[", "c2", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"bu", "+", 
         RowBox[{"Sqrt", "[", "c2", "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"n", ",", "u"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chyqmom", "[", "momin_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"moms", "=", "momin"}], ",", "eqns", ",", "vars", ",", 
        "linsolv", ",", "pm", ",", "mymom", ",", "n", ",", "bu", ",", "bv", 
        ",", "d20", ",", "d11", ",", "d02", ",", "c20", ",", "c11", ",", 
        "c02", ",", "M1", ",", "rho", ",", "up", ",", "Vf", ",", "mu2avg", 
        ",", "mu2", ",", "M3", ",", "rh3", ",", "up3", ",", "vp21", ",", 
        "vp22", ",", "rho21", ",", "rho22", ",", "u", ",", "v"}], "}"}], ",", 
      "\n", "\t", 
      RowBox[{"(*", " ", "pointer", " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"eqns", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"moms", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", 
           RowBox[{"pm", "[", 
            RowBox[{
             RowBox[{"ks", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"ks", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}]}], ";", "\n",
        "\t", 
       RowBox[{"vars", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"pm", "[", 
             RowBox[{
              RowBox[{"ks", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"ks", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}], "]"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"linsolv", "=", 
        RowBox[{"First", "[", 
         RowBox[{"vars", "/.", 
          RowBox[{"Solve", "[", 
           RowBox[{"eqns", ",", "vars"}], "]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"mymom", "[", 
         RowBox[{"q_", ",", "p_"}], "]"}], ":=", 
        RowBox[{"linsolv", "[", 
         RowBox[{"[", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Position", "[", 
             RowBox[{"ks", ",", 
              RowBox[{"{", 
               RowBox[{"q", ",", "p"}], "}"}]}], "]"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\n", "\t", 
       RowBox[{"n", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"u", "=", "n"}], ";", 
       RowBox[{"v", "=", "n"}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"mean", " ", "velocities"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"bu", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"1", ",", "0"}], "]"}], "/", 
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"bv", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "1"}], "]"}], "/", 
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"normalized", " ", "moments"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"d20", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"2", ",", "0"}], "]"}], "/", 
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"d11", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "/", 
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"d02", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "2"}], "]"}], "/", 
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"(*", 
        RowBox[{"central", " ", "moments"}], "*)"}], "\n", "\t", 
       RowBox[{"c20", "=", 
        RowBox[{"d20", "-", 
         SuperscriptBox["bu", "2"]}]}], ";", "\n", "\t", 
       RowBox[{"c11", "=", 
        RowBox[{"d11", "-", 
         RowBox[{"bu", " ", "bv"}]}]}], ";", "\n", "\t", 
       RowBox[{"c02", "=", 
        RowBox[{"d02", "-", 
         SuperscriptBox["bv", "2"]}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
        "3", " ", "node", " ", "hyqmom", " ", "with", " ", "realizability", 
         " ", "checking"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"M1", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "c20"}], "}"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rho", ",", "up"}], "}"}], "=", 
        RowBox[{"hyqmom", "[", "M1", "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"HyQMOM", " ", "-", " ", 
          RowBox[{
          "condition", " ", "on", " ", "u", " ", "direction", " ", "with", 
           " ", "c20"}]}], " ", ">", " ", "0"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"Vf", "=", 
        RowBox[{"c11", " ", 
         RowBox[{"up", "/", "c20"}]}]}], ";", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"find", " ", "conditional", " ", "variance"}], " ", "*)"}], 
       "\n", "\t", 
       RowBox[{"mu2avg", "=", 
        RowBox[{"c02", "-", 
         RowBox[{"Total", "[", 
          RowBox[{"rho", " ", 
           SuperscriptBox["Vf", "2"]}], "]"}]}]}], ";", "\n", "\t", 
       RowBox[{"mu2avg", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"mu2avg", ",", "0"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"mu2", "=", "mu2avg"}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"2", "-", 
         RowBox[{"node", " ", "HyQMOM"}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{"M3", "=", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "mu2"}], "}"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rh3", ",", "up3"}], "}"}], "=", 
        RowBox[{"hyqmom", "[", "M3", "]"}]}], ";", "\n", "\t", 
       RowBox[{"vp21", "=", 
        RowBox[{"up3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"vp22", "=", 
        RowBox[{"up3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rho21", "=", 
        RowBox[{"rh3", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rho22", "=", 
        RowBox[{"rh3", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", "weights", " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"rho", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "rho21"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"rho", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "rho22"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"rho", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "rho21"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"rho", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "rho22"}]}], ";", "\n", "\t", 
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"mymom", "[", 
          RowBox[{"0", ",", "0"}], "]"}], "n"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"dir", "-", 
         RowBox[{"1", " ", "abscissas"}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"up", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"up", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"up", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{"up", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"u", "=", 
        RowBox[{"bu", "+", "u"}]}], ";", "\n", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"dir", "-", 
         RowBox[{"2", " ", "abscissas"}]}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Vf", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "vp21"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Vf", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "vp22"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Vf", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "vp21"}]}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"Vf", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "vp22"}]}], ";", "\n", "\t", 
       RowBox[{"v", "=", 
        RowBox[{"bv", "+", "v"}]}], ";", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"n", ",", "u", ",", "v"}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myrhs", "[", 
    RowBox[{"momin_", ",", "tin_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"moms", "=", "momin"}], ",", 
       RowBox[{"t", "=", "tin"}], ",", "rhs", ",", "momout", ",", "mom", ",", 
       "l", ",", "m", ",", "w"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", ",", "xix", ",", "xiy"}], "}"}], "=", 
       RowBox[{"chyqmom", "[", "moms", "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"mom", "[", 
        RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          SuperscriptBox[
           RowBox[{"xix", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "p"], 
          SuperscriptBox[
           RowBox[{"xiy", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "q"]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"nr", " ", "nrd"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"rhs", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t", 
      RowBox[{"Do", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"l", ",", "m"}], "}"}], "=", 
          RowBox[{"ks", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"model", "\[Equal]", "\"\<linear\>\""}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"rhs", ",", 
             RowBox[{
              RowBox[{"l", " ", 
               RowBox[{"mom", "[", 
                RowBox[{
                 RowBox[{"l", "-", "1"}], ",", 
                 RowBox[{"m", "+", "1"}]}], "]"}]}], "-", 
              RowBox[{"m", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox["4", "Rey"], 
                  RowBox[{"mom", "[", 
                   RowBox[{"l", ",", "m"}], "]"}]}], "+", 
                 RowBox[{"2", " ", "\[Gamma]", " ", "Ca", " ", 
                  RowBox[{"mom", "[", 
                   RowBox[{
                    RowBox[{"l", "+", "1"}], ",", 
                    RowBox[{"m", "-", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"Cp", "[", "t", "]"}], " ", 
                  RowBox[{"mom", "[", 
                   RowBox[{"l", ",", 
                    RowBox[{"m", "-", "1"}]}], "]"}]}]}], ")"}]}]}]}], 
            "]"}]}], "]"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"model", "\[Equal]", "\"\<nonlinear\>\""}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"rhs", ",", 
             RowBox[{
              RowBox[{"l", " ", 
               RowBox[{"mom", "[", 
                RowBox[{
                 RowBox[{"l", "-", "1"}], ",", 
                 RowBox[{"m", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{"m", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"mom", "[", 
                  RowBox[{
                   RowBox[{"l", "-", "1", "-", 
                    RowBox[{"3", "\[Gamma]"}]}], ",", 
                   RowBox[{"m", "-", "1"}]}], "]"}], "-", 
                 RowBox[{
                  FractionBox["3", "2"], " ", 
                  RowBox[{"mom", "[", 
                   RowBox[{
                    RowBox[{"l", "-", "1"}], ",", 
                    RowBox[{"m", "+", "1"}]}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Cp", "[", "t", "]"}], " ", 
                  RowBox[{"mom", "[", 
                   RowBox[{
                    RowBox[{"l", "-", "1"}], ",", 
                    RowBox[{"m", "-", "1"}]}], "]"}]}]}], ")"}]}]}]}], 
            "]"}]}], "]"}], ";"}], "\n", "\t", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"momout", ",", "momsp"}], "}"}], "=", 
       RowBox[{"project", "[", 
        RowBox[{
        "xix", ",", "xiy", ",", "w", ",", "ks", ",", "ksp", ",", "nr", ",", 
         "nrd"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"momout", ",", "rhs"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.791142984468623*^9, 3.791143024190052*^9}, {
   3.791143057332169*^9, 3.791143103007327*^9}, {3.791143340365391*^9, 
   3.7911433615298653`*^9}, {3.791143532113022*^9, 3.791143661518359*^9}, {
   3.7911437207896147`*^9, 3.791143837860985*^9}, {3.791143899136118*^9, 
   3.791143899217778*^9}, {3.791144169717822*^9, 3.791144195116453*^9}, {
   3.791144290244565*^9, 3.7911442904363956`*^9}, {3.791144570374895*^9, 
   3.7911445818261414`*^9}, {3.791145833969863*^9, 3.7911458423491087`*^9}, {
   3.791146661999239*^9, 3.7911466621112947`*^9}, {3.791146692360744*^9, 
   3.791146701287784*^9}, {3.791146749685299*^9, 3.79114674979082*^9}, 
   3.791202874412874*^9, {3.791203009420932*^9, 3.79120303588227*^9}, {
   3.7912031033498*^9, 3.791203129308031*^9}, {3.791203603861773*^9, 
   3.7912036039508667`*^9}, {3.791203636249996*^9, 3.791203638618215*^9}, {
   3.791203677222204*^9, 3.791203678250763*^9}, {3.791203795581809*^9, 
   3.7912038060007*^9}, {3.791204858880205*^9, 3.791204858977512*^9}, {
   3.791205081180812*^9, 3.7912050973745747`*^9}, {3.791210270864773*^9, 
   3.791210272699856*^9}, {3.791210623481488*^9, 3.7912106235729227`*^9}, {
   3.791210938772298*^9, 3.791210939335239*^9}, {3.791224533699617*^9, 
   3.791224534108959*^9}, {3.7912888376776447`*^9, 3.791288837762395*^9}, {
   3.7912889256708803`*^9, 3.791288925789076*^9}, {3.79128920465589*^9, 
   3.7912892047732477`*^9}, {3.7912895297671022`*^9, 3.791289606487877*^9}, {
   3.791289717952716*^9, 3.791289792079417*^9}, {3.791289833065124*^9, 
   3.791289874121566*^9}, {3.791289916798995*^9, 3.791289957912936*^9}, {
   3.7912910104908247`*^9, 3.791291010611403*^9}, {3.791291580671884*^9, 
   3.791291590838819*^9}, {3.791293306681916*^9, 3.791293313729233*^9}, {
   3.79129372929001*^9, 3.791293737638625*^9}, {3.791293785102961*^9, 
   3.791293787441023*^9}, {3.791294385854725*^9, 3.7912943878848867`*^9}, {
   3.791296765187694*^9, 3.791296765650393*^9}, {3.791298578836258*^9, 
   3.791298591828898*^9}, {3.7913000157391253`*^9, 3.791300042070973*^9}, {
   3.791300107108718*^9, 3.791300107243761*^9}, {3.791300402623376*^9, 
   3.7913004028843203`*^9}, {3.7913004513091583`*^9, 3.791300451354726*^9}, {
   3.791300657244422*^9, 3.79130070845714*^9}, {3.791309246810129*^9, 
   3.79130932897051*^9}, {3.7913093597447863`*^9, 3.791309484986393*^9}, {
   3.791309836538281*^9, 3.7913098368241*^9}, {3.791309898024563*^9, 
   3.79130995063616*^9}, {3.7913099926312437`*^9, 3.7913100534193983`*^9}, {
   3.791310583276626*^9, 3.791310689879648*^9}, {3.791310764750839*^9, 
   3.791310767545475*^9}, {3.79131085863927*^9, 3.7913108952117043`*^9}, {
   3.791311074181958*^9, 3.791311122626431*^9}, {3.791311211103284*^9, 
   3.7913112718551807`*^9}, {3.7913118068463507`*^9, 3.791311806911317*^9}, {
   3.791311838180505*^9, 3.791311839001549*^9}, {3.79131216272936*^9, 
   3.791312165523795*^9}, {3.791312351007345*^9, 3.7913123603338213`*^9}, {
   3.79131274487906*^9, 3.791312745127096*^9}, {3.791314347369783*^9, 
   3.791314352090109*^9}, {3.791314861225994*^9, 3.791314872427746*^9}, {
   3.791314905688676*^9, 3.791314906299644*^9}, {3.7913149674918833`*^9, 
   3.791314973230187*^9}, {3.791315041936207*^9, 3.791315042095223*^9}, {
   3.791317558370534*^9, 3.7913176007256727`*^9}, {3.791317669990158*^9, 
   3.791317699194661*^9}, {3.791317810838574*^9, 3.791317811135338*^9}, {
   3.791318022854055*^9, 3.791318023013101*^9}, {3.791318255544602*^9, 
   3.791318267042509*^9}, {3.791319048650838*^9, 3.791319211082202*^9}, {
   3.791319264694046*^9, 3.791319282956594*^9}, {3.791322978059557*^9, 
   3.791322982948575*^9}, {3.791323051730473*^9, 3.791323112418227*^9}, {
   3.791323148256209*^9, 3.791323149907827*^9}, {3.791323206464706*^9, 
   3.791323241534733*^9}, 3.791323304531878*^9, 3.7913233457413*^9, {
   3.791323472251462*^9, 3.7913234859294043`*^9}, {3.7913235869736137`*^9, 
   3.7913235977164927`*^9}, {3.791323640582528*^9, 3.791323671393216*^9}, 
   3.79132371389487*^9, {3.791323750563092*^9, 3.791323786889531*^9}, {
   3.7913238669074383`*^9, 3.791323876929566*^9}, {3.791334579550972*^9, 
   3.791334579658202*^9}, {3.791334617141838*^9, 3.791334622632812*^9}, {
   3.791573274742017*^9, 3.791573311218883*^9}, {3.791573378164733*^9, 
   3.791573380545079*^9}, {3.791573431984459*^9, 3.791573462096126*^9}, {
   3.791573502727804*^9, 3.7915735691240396`*^9}, {3.791573624050036*^9, 
   3.791573625157583*^9}, {3.794150302373706*^9, 3.794150302461966*^9}, {
   3.794150550981814*^9, 3.7941505526318808`*^9}, {3.794150623524104*^9, 
   3.794150624151078*^9}, {3.794150681699059*^9, 3.794150752080127*^9}, {
   3.79415392814813*^9, 3.7941539283163843`*^9}, {3.794164212134897*^9, 
   3.7941642124742002`*^9}, {3.794164303660139*^9, 3.794164433203074*^9}, {
   3.794164834288348*^9, 3.794164840247826*^9}, {3.7941648993641567`*^9, 
   3.794164919823555*^9}, {3.794165191684065*^9, 3.7941651917778463`*^9}, {
   3.7941652650299683`*^9, 3.794165268924136*^9}, {3.794165546479169*^9, 
   3.794165595503689*^9}, {3.794165626589829*^9, 3.794165626668276*^9}, 
   3.7941656796042347`*^9, {3.794166216471759*^9, 3.794166216594324*^9}, {
   3.794166669294573*^9, 3.7941666693794107`*^9}, {3.794167060031766*^9, 
   3.794167133968347*^9}, {3.794168466204317*^9, 3.7941684663735647`*^9}, {
   3.794168614860722*^9, 3.794168619637796*^9}, {3.794169990799638*^9, 
   3.794170001226865*^9}, {3.794170127908968*^9, 3.794170287904213*^9}, {
   3.79417043820546*^9, 3.7941704708565903`*^9}, {3.794170511997052*^9, 
   3.794170598871449*^9}, {3.79417063081391*^9, 3.794170661524247*^9}, {
   3.794170725501292*^9, 3.794170800354678*^9}, {3.7941709671245317`*^9, 
   3.794171125257885*^9}, 3.794171447846758*^9, 3.794171592070744*^9, {
   3.79417168531811*^9, 3.794171695368561*^9}, {3.794172689440976*^9, 
   3.7941727065459642`*^9}, {3.794172741137411*^9, 3.7941727462545013`*^9}, {
   3.79417278929653*^9, 3.794172819351659*^9}, 3.794172884869155*^9, {
   3.794173028332857*^9, 3.794173065899969*^9}, 3.794173140361129*^9, {
   3.794173326549518*^9, 3.7941733387486563`*^9}, {3.794173465126549*^9, 
   3.794173499487625*^9}, {3.794173602707889*^9, 3.794173605168083*^9}, 
   3.7941737545077457`*^9, {3.7941741322963333`*^9, 3.794174159352036*^9}, {
   3.794174237995761*^9, 3.79417425810178*^9}, {3.794174347601138*^9, 
   3.794174353022691*^9}, {3.7941772190630007`*^9, 3.794177222690394*^9}, {
   3.794179878468916*^9, 3.794179879778315*^9}, {3.7942349063474417`*^9, 
   3.794234907188891*^9}, {3.794234948074719*^9, 3.794234982270671*^9}, 
   3.7942350568442373`*^9, 3.7942351865701942`*^9, 3.7942353623769493`*^9, {
   3.794235443304277*^9, 3.79423544478699*^9}, {3.794235885634644*^9, 
   3.794235900802781*^9}, {3.7942361295372047`*^9, 3.794236130348853*^9}, {
   3.7942373007947683`*^9, 3.794237301284034*^9}, {3.794237445230813*^9, 
   3.794237446133252*^9}, {3.794237956792686*^9, 3.7942379674959173`*^9}, {
   3.794237998297345*^9, 3.7942379984492617`*^9}, {3.794238261527652*^9, 
   3.79423827391088*^9}, {3.794238328596464*^9, 3.794238331612296*^9}, {
   3.7942383620849743`*^9, 3.794238362217823*^9}, {3.794238508686573*^9, 
   3.794238510175973*^9}, {3.7942385521418447`*^9, 3.794238571062804*^9}, {
   3.794238605766658*^9, 3.7942386265851107`*^9}, {3.794244335961768*^9, 
   3.794244336051483*^9}, {3.794244828092743*^9, 3.7942448281833572`*^9}, {
   3.7942496505582447`*^9, 3.794249651806156*^9}, {3.794256670167718*^9, 
   3.794256676969942*^9}, 3.794256709741158*^9, {3.794261378112599*^9, 
   3.794261403732445*^9}, 3.794273931077464*^9, {3.794588472932179*^9, 
   3.794588475208272*^9}, {3.794589572407711*^9, 3.7945895731813087`*^9}, {
   3.794597364035611*^9, 3.794597365802967*^9}, {3.7946005918695707`*^9, 
   3.794600592700678*^9}, {3.794602199093165*^9, 3.794602213762855*^9}, {
   3.794604368251631*^9, 3.7946043683731213`*^9}, {3.7946045119666157`*^9, 
   3.794604512598021*^9}, {3.7946153107005033`*^9, 3.79461531143279*^9}, {
   3.794659111725368*^9, 3.7946591162892113`*^9}, {3.794659265222217*^9, 
   3.794659290842023*^9}, {3.79465941284485*^9, 3.7946594129258137`*^9}, {
   3.794659546971087*^9, 3.794659552350618*^9}, {3.794659679720641*^9, 
   3.794659700937828*^9}, {3.794660021247188*^9, 3.794660021966886*^9}, {
   3.7946601085419292`*^9, 3.794660108659109*^9}, {3.794660152660926*^9, 
   3.794660153747839*^9}, {3.79466048429926*^9, 3.794660485556622*^9}, {
   3.794660626227064*^9, 3.794660626356492*^9}, {3.794660673575315*^9, 
   3.7946606737015553`*^9}, {3.794660813050284*^9, 3.794660813199922*^9}, {
   3.7946608519632998`*^9, 3.7946608601472588`*^9}, {3.794660930384306*^9, 
   3.794660961951859*^9}, {3.794661144494841*^9, 3.7946611446524076`*^9}, {
   3.794661899867601*^9, 3.794661900580208*^9}, {3.794662126956594*^9, 
   3.7946621271412897`*^9}, {3.7946622214682302`*^9, 3.794662221617299*^9}, {
   3.794662374261613*^9, 3.794662388288485*^9}, {3.7946624589415827`*^9, 
   3.79466245958416*^9}, {3.794662658693874*^9, 3.7946626592161303`*^9}, {
   3.794662915310611*^9, 3.794662918043605*^9}, {3.7946641302989883`*^9, 
   3.7946641349167128`*^9}, {3.794664166194916*^9, 3.7946641895110607`*^9}, 
   3.794664291287825*^9, {3.794664628236685*^9, 3.794664674766157*^9}, {
   3.794665250247141*^9, 3.794665250715158*^9}, {3.7947573489883003`*^9, 
   3.794757504698255*^9}, {3.7947575711969223`*^9, 3.794757696065606*^9}, {
   3.7947578097408047`*^9, 3.794757809791503*^9}, {3.794758121974444*^9, 
   3.794758122927753*^9}, {3.794758190995049*^9, 3.794758211423648*^9}, 
   3.7947594065403013`*^9, {3.794767283268949*^9, 3.794767284320072*^9}, {
   3.794767445006589*^9, 3.794767445242652*^9}, {3.79476791701655*^9, 
   3.794767921949284*^9}, {3.794768003176612*^9, 3.79476800428356*^9}, {
   3.79476832907728*^9, 3.794768350628357*^9}, {3.794768425619586*^9, 
   3.794768434567952*^9}, {3.794780506655349*^9, 3.7947805265899897`*^9}, {
   3.794863067121388*^9, 3.79486309327244*^9}, {3.794863128533242*^9, 
   3.794863170353341*^9}, {3.794863916814159*^9, 3.794863926124363*^9}, 
   3.794863972111415*^9, {3.794864004235664*^9, 3.79486400900613*^9}, {
   3.794864066697912*^9, 3.794864079260516*^9}, {3.7948642013679028`*^9, 
   3.794864203956921*^9}, {3.7948642562246923`*^9, 3.794864264720634*^9}, {
   3.794864390803069*^9, 3.794864392471279*^9}, {3.7948644255724897`*^9, 
   3.794864514435556*^9}, {3.794864814786482*^9, 3.794864834387409*^9}, {
   3.7948648837045527`*^9, 3.794864966935555*^9}, {3.794865067664023*^9, 
   3.794865071866333*^9}, {3.794865278709249*^9, 3.794865279316077*^9}, {
   3.794865348846891*^9, 3.7948653495176077`*^9}, {3.794866421902938*^9, 
   3.7948664398198347`*^9}, {3.7948664733576393`*^9, 3.794866540372506*^9}, {
   3.7948670052791*^9, 3.794867027783162*^9}, {3.794867598738681*^9, 
   3.794867600164914*^9}, {3.794867763015451*^9, 3.794867763820868*^9}, 
   3.7948678559299717`*^9, {3.794922205154935*^9, 3.7949222053525343`*^9}, {
   3.794922280208413*^9, 3.7949222803059*^9}, {3.794922389722949*^9, 
   3.794922390875926*^9}, {3.794922582234523*^9, 3.794922583708406*^9}, {
   3.79492389173691*^9, 3.79492389245117*^9}, {3.794923958822386*^9, 
   3.794923960340961*^9}, {3.7949242863450727`*^9, 3.794924286409952*^9}, 
   3.794940798003563*^9, {3.794940841640121*^9, 3.794940842327688*^9}, {
   3.7949489193139763`*^9, 3.7949489195971003`*^9}, {3.794948982418054*^9, 
   3.794948984489252*^9}, {3.794949086236266*^9, 3.79494908691778*^9}, {
   3.794949240032219*^9, 3.794949240812096*^9}, {3.794949303782345*^9, 
   3.794949348820918*^9}, {3.7949509039380693`*^9, 3.794950906120841*^9}, {
   3.7949510925908937`*^9, 3.7949510937422037`*^9}, {3.794952994146796*^9, 
   3.7949529949099197`*^9}, {3.7958798929915543`*^9, 3.79587989697143*^9}, {
   3.7958923445706177`*^9, 3.7958923454653587`*^9}, {3.795893480612862*^9, 
   3.795893481523033*^9}, {3.7958935320434723`*^9, 3.795893533114952*^9}, {
   3.795893644110415*^9, 3.795893644907036*^9}, {3.795894339828856*^9, 
   3.795894340198645*^9}, 3.795894520207048*^9, {3.795894586322596*^9, 
   3.795894586850298*^9}, {3.795894646483609*^9, 3.7958946565368357`*^9}, {
   3.7958948452257566`*^9, 3.79589484529174*^9}, {3.795895044244814*^9, 
   3.795895045453933*^9}, {3.795895187907072*^9, 3.7958951900084476`*^9}, {
   3.795895240066675*^9, 3.795895249215631*^9}, {3.795895366841878*^9, 
   3.795895367023464*^9}, {3.79595605676683*^9, 3.795956078059222*^9}, {
   3.79595616342409*^9, 3.795956166677472*^9}, {3.795957387435341*^9, 
   3.795957421429246*^9}, {3.795957707185822*^9, 3.795957754987953*^9}, {
   3.795957851480523*^9, 3.79595785223624*^9}, {3.795957899515517*^9, 
   3.795957899579411*^9}, {3.795958539399719*^9, 3.7959585639133863`*^9}, {
   3.79595904418692*^9, 3.7959590442437487`*^9}, {3.795959451140333*^9, 
   3.7959594560632553`*^9}, {3.795959575801633*^9, 3.795959575928887*^9}, {
   3.7959624428112803`*^9, 3.795962443810663*^9}, {3.795962516471924*^9, 
   3.795962534878656*^9}, {3.795963101722855*^9, 3.7959631025300703`*^9}, {
   3.79596349285515*^9, 3.795963494131843*^9}, {3.795964098422851*^9, 
   3.795964099099783*^9}, {3.795965292703999*^9, 3.795965293450248*^9}, {
   3.795966134191503*^9, 3.795966134956699*^9}, {3.7959682689102573`*^9, 
   3.795968268954637*^9}, {3.7959691590784883`*^9, 3.795969159624298*^9}, {
   3.79596944933806*^9, 3.795969449483096*^9}, {3.795969705354931*^9, 
   3.795969705462825*^9}, {3.79597160055725*^9, 3.795971600593042*^9}, {
   3.7959722095574713`*^9, 3.795972211067711*^9}, {3.7960457734560347`*^9, 
   3.796045774775363*^9}, {3.7960462468959208`*^9, 3.7960462476122704`*^9}, {
   3.796046445439913*^9, 3.7960464538039*^9}, {3.796047116780466*^9, 
   3.796047135742544*^9}, {3.796050891361627*^9, 3.796050901863871*^9}, {
   3.796059951017103*^9, 3.796059951098493*^9}, {3.79606449071175*^9, 
   3.7960644914402514`*^9}, {3.796065509269965*^9, 3.796065510254753*^9}, {
   3.796065617001367*^9, 3.796065617707116*^9}, {3.796065676180703*^9, 
   3.796065685894945*^9}, {3.796065848229829*^9, 3.796065850271343*^9}, {
   3.79606591247853*^9, 3.79606591450773*^9}, {3.7960685724797173`*^9, 
   3.796068573374411*^9}, {3.796068666921301*^9, 3.796068668475153*^9}, {
   3.796068714895433*^9, 3.7960687332861013`*^9}, {3.796132600735703*^9, 
   3.796132606591097*^9}, {3.796133385015951*^9, 3.7961334618089743`*^9}, {
   3.796133530989455*^9, 3.796133654483004*^9}, {3.796134434605747*^9, 
   3.796134436324746*^9}, {3.796134830633329*^9, 3.796134834591201*^9}, {
   3.796134958054055*^9, 3.796134958864396*^9}, {3.7961355280118093`*^9, 
   3.7961355331257067`*^9}, {3.796136134874542*^9, 3.796136141779146*^9}, {
   3.796136271928379*^9, 3.7961362719837523`*^9}, {3.796136471179016*^9, 
   3.796136472859436*^9}, {3.7961365702295923`*^9, 3.796136574246172*^9}, {
   3.796136908204904*^9, 3.796136914773019*^9}, {3.796141582212635*^9, 
   3.796141583847476*^9}, {3.796141946855507*^9, 3.7961419475668507`*^9}, {
   3.796143915013809*^9, 3.796143915905252*^9}, {3.7961575945350103`*^9, 
   3.796157602585258*^9}, {3.796159111149428*^9, 3.796159145674419*^9}, {
   3.796159275795332*^9, 3.7961592758844433`*^9}, {3.7961595828570957`*^9, 
   3.7961595835583887`*^9}, {3.796160643798581*^9, 3.7961606596418743`*^9}, {
   3.796160701374156*^9, 3.796160718108992*^9}, {3.7961607534690237`*^9, 
   3.79616078523393*^9}, {3.7961608246414824`*^9, 3.7961608504784193`*^9}, 
   3.7961608829735823`*^9, {3.796163183299171*^9, 3.7961631847670937`*^9}, {
   3.796217966088491*^9, 3.796217968392737*^9}, {3.7962202420542097`*^9, 
   3.7962202482556553`*^9}, {3.796220293529587*^9, 3.796220383407812*^9}, {
   3.796220442208292*^9, 3.796220474037014*^9}, {3.796239604244462*^9, 
   3.7962396290777683`*^9}, {3.7963111516527233`*^9, 
   3.7963111686372147`*^9}, {3.7969480065731173`*^9, 3.796948075344792*^9}, {
   3.796948105798967*^9, 3.796948111833836*^9}, {3.796948246382945*^9, 
   3.796948288829105*^9}, {3.7969485160498533`*^9, 3.796948883550477*^9}, {
   3.796948919258019*^9, 3.79694958745275*^9}, {3.7969496489162693`*^9, 
   3.796949682687392*^9}, {3.796949719540196*^9, 3.796949858020444*^9}, {
   3.796949904432397*^9, 3.7969499902226152`*^9}, {3.796950022060136*^9, 
   3.796950234319257*^9}, {3.796950273358801*^9, 3.7969503409161463`*^9}, {
   3.7969504033483763`*^9, 3.796950734204109*^9}, {3.7969524978464127`*^9, 
   3.796952499868104*^9}, {3.796952735525111*^9, 3.7969530000583*^9}, {
   3.796953102222466*^9, 3.796953114608746*^9}, {3.7969866749520607`*^9, 
   3.796986758022401*^9}, {3.79698681127078*^9, 3.796988030796034*^9}, {
   3.796988061677198*^9, 3.796988156482703*^9}, {3.796988602319867*^9, 
   3.796988623175439*^9}, {3.797000592116108*^9, 3.797000633240387*^9}, {
   3.79700074650559*^9, 3.7970007942785873`*^9}, {3.7970008276891747`*^9, 
   3.7970008284387197`*^9}, {3.7970010753960733`*^9, 3.797001235844514*^9}, {
   3.7970012812841454`*^9, 3.7970013038364363`*^9}, {3.797001335658567*^9, 
   3.797001369644137*^9}, {3.797001622086887*^9, 3.797001705469273*^9}, {
   3.7970017479581327`*^9, 3.79700175341043*^9}, {3.7970018279262657`*^9, 
   3.7970018322669477`*^9}, {3.797002681800692*^9, 3.797002684813621*^9}, 
   3.797002798132943*^9, {3.797002994228348*^9, 3.7970030393003197`*^9}, 
   3.797003682079505*^9, {3.7970042294540987`*^9, 3.797004232447699*^9}, {
   3.7970048286817102`*^9, 3.797004830602934*^9}, {3.7970048837288933`*^9, 
   3.797004896114633*^9}, {3.797004949506225*^9, 3.797004961425858*^9}, {
   3.797005014067327*^9, 3.797005015392703*^9}, {3.797005375236377*^9, 
   3.797005376713389*^9}, {3.797005410510083*^9, 3.797005414331512*^9}, {
   3.797005604072801*^9, 3.797005604630762*^9}, {3.7970056545862217`*^9, 
   3.797005683278758*^9}, {3.797005763154624*^9, 3.79700576422202*^9}, {
   3.797006268606422*^9, 3.797006274857156*^9}, {3.797006418153857*^9, 
   3.797006424497388*^9}, {3.7970065177721786`*^9, 3.797006521505413*^9}, {
   3.797008429357822*^9, 3.797008521659235*^9}, {3.797009027511614*^9, 
   3.797009027667123*^9}, {3.797009116728692*^9, 3.7970091478563633`*^9}, {
   3.797009182448761*^9, 3.797009189198379*^9}, {3.7970094139023733`*^9, 
   3.79700941395481*^9}, {3.797016275102203*^9, 3.797016281959581*^9}, 
   3.797016482773961*^9, 3.79701839777892*^9, {3.797018634699202*^9, 
   3.797018634774374*^9}, 3.7970186948028307`*^9, {3.797018742528192*^9, 
   3.797018742809577*^9}, {3.797018795261014*^9, 3.797018795516453*^9}, {
   3.797018896063067*^9, 3.7970188961390142`*^9}, {3.797019205997444*^9, 
   3.797019206060811*^9}, {3.7970196522460737`*^9, 3.797019652478991*^9}, {
   3.797019724393211*^9, 3.79701972615203*^9}, {3.7970198213529882`*^9, 
   3.797019827620968*^9}, {3.797019905645823*^9, 3.797019906215282*^9}, {
   3.797020389412477*^9, 3.797020389870256*^9}, {3.7970208799597797`*^9, 
   3.797020885300703*^9}, {3.797020946248334*^9, 3.797020946320539*^9}, {
   3.797021165447485*^9, 3.797021168679998*^9}, {3.797087219357266*^9, 
   3.797087250854212*^9}, {3.79708779573103*^9, 3.797087797551525*^9}, {
   3.797088654204769*^9, 3.7970886839519033`*^9}, {3.797088797252124*^9, 
   3.797088800238798*^9}, {3.797091028891964*^9, 3.797091028964375*^9}, {
   3.797091126364181*^9, 3.797091126498519*^9}, {3.7970912430427103`*^9, 
   3.7970912433345537`*^9}, {3.797091339914917*^9, 3.797091340562796*^9}, {
   3.797091399312688*^9, 3.797091399391775*^9}, 3.7970914777986717`*^9, {
   3.797168097383724*^9, 3.797168114792238*^9}, {3.797173695807724*^9, 
   3.79717369923032*^9}, {3.797173919554318*^9, 3.797173921876423*^9}, {
   3.797184974782563*^9, 3.7971853357384357`*^9}, {3.7971854125335207`*^9, 
   3.797185577572785*^9}, {3.797186253972476*^9, 3.797186282622871*^9}, {
   3.797251516964799*^9, 3.797251636888948*^9}, {3.797251870180668*^9, 
   3.797251886365224*^9}, {3.797252073302219*^9, 3.7972520957811537`*^9}, {
   3.797252729525835*^9, 3.797252776965702*^9}, {3.797254715785685*^9, 
   3.797254715904036*^9}, {3.7972555855573797`*^9, 3.7972555856278067`*^9}, {
   3.7972584173104687`*^9, 3.797258444930893*^9}, {3.797260134508705*^9, 
   3.79726013521659*^9}, {3.797260206228588*^9, 3.797260206977953*^9}, {
   3.797260259508547*^9, 3.797260262027918*^9}, {3.797260567589995*^9, 
   3.7972605824203253`*^9}, {3.797260904518188*^9, 3.7972609226687737`*^9}, {
   3.797260982235942*^9, 3.7972609837741747`*^9}, {3.797261195332272*^9, 
   3.79726121880079*^9}, {3.797261279855864*^9, 3.7972612815535393`*^9}, {
   3.797262812962257*^9, 3.797262868037766*^9}, {3.797263069794088*^9, 
   3.797263070250626*^9}, {3.7972631516273527`*^9, 3.797263153052808*^9}, {
   3.797263440194149*^9, 3.797263440258514*^9}, {3.7972639718135967`*^9, 
   3.797263989122065*^9}, {3.797264152939664*^9, 3.797264248058085*^9}, {
   3.797264301646659*^9, 3.797264402572914*^9}, {3.79726448865521*^9, 
   3.797264489289405*^9}, {3.797264611419969*^9, 3.7972646140912046`*^9}, {
   3.797264948189959*^9, 3.797264971705392*^9}, {3.797265036259445*^9, 
   3.797265036337878*^9}, {3.797265124818801*^9, 3.797265127512006*^9}, {
   3.797265183050705*^9, 3.797265183093927*^9}, {3.797266477090213*^9, 
   3.7972664800066977`*^9}, {3.797266576382539*^9, 3.7972665780667*^9}, {
   3.797266629680004*^9, 3.7972666297311277`*^9}, {3.797267371055078*^9, 
   3.797267397412446*^9}, {3.797267456934989*^9, 3.797267478639592*^9}, {
   3.797267534457616*^9, 3.7972675345013533`*^9}, {3.79726795245919*^9, 
   3.797268144864079*^9}, {3.797268178051001*^9, 3.797268212752255*^9}, {
   3.797268535449276*^9, 3.797268646717574*^9}, {3.7972687217297497`*^9, 
   3.7972688098755627`*^9}, {3.7972688461528177`*^9, 3.797268846315056*^9}, {
   3.797268955206903*^9, 3.7972689974859447`*^9}, {3.7972694870333652`*^9, 
   3.797269487084783*^9}, {3.79727001844211*^9, 3.797270018501629*^9}, {
   3.79727729985711*^9, 3.7972773038813477`*^9}, 3.7972774376440573`*^9, {
   3.797281949643701*^9, 3.797281950475643*^9}, {3.797285094328281*^9, 
   3.79728510545187*^9}},ExpressionUUID->"14ef2037-6e1d-4aef-8e01-\
4b3a06744e68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ic", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"momRRd", "[", 
      RowBox[{
       RowBox[{"ks", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"ks", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"moms", "=", "ic"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sol", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"ts", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"dets", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"abscissa", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"spsol", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"t", "\[LessEqual]", "T"}], ",", "\n", "\t", 
       RowBox[{"(*", " ", 
        RowBox[{"SSP", "-", "RK2"}], " ", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"moms", ",", "rhs"}], "}"}], "=", 
         RowBox[{"myrhs", "[", 
          RowBox[{"moms", ",", "t"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"momstemp1", "=", 
         RowBox[{"moms", "+", 
          RowBox[{"dt", " ", "rhs"}]}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"momstemp1", ",", "rhs"}], "}"}], "=", 
         RowBox[{"myrhs", "[", 
          RowBox[{"momstemp1", ",", 
           RowBox[{"t", "+", "dt"}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"mome", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], " ", "moms"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"momstemp1", "+", 
             RowBox[{"dt", " ", "rhs"}]}], ")"}]}]}]}], ";", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"SSP", "-", "RK3"}], " ", "*)"}], "\n", "\t", 
        RowBox[{"momstemp2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "/", "4"}], ")"}], "moms"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "4"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"momstemp1", "+", 
             RowBox[{"dt", " ", "rhs"}]}], ")"}]}]}]}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"momtemp2", ",", "rhs"}], "}"}], "=", 
         RowBox[{"myrhs", "[", 
          RowBox[{"momstemp2", ",", 
           RowBox[{"t", "+", 
            RowBox[{"dt", "/", "2"}]}]}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"moms", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "3"}], ")"}], "moms"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "/", "3"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"momtemp2", "+", 
             RowBox[{"dt", " ", "rhs"}]}], ")"}]}]}]}], ";", "\n", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"abscissa", ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"xix", ",", "xiy"}], "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"sol", ",", "moms"}], "]"}], ";", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"spsol", ",", "momsp"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"ts", ",", "t"}], "]"}], ";", "\n", "\[IndentingNewLine]", 
        RowBox[{"t", "=", 
         RowBox[{"t", "+", "dt"}]}], ";", "\n", "\t", 
        RowBox[{"e", "=", 
         FractionBox[
          RowBox[{"Norm", "[", 
           RowBox[{"moms", "-", "mome"}], "]"}], 
          RowBox[{"Norm", "[", "moms", "]"}]]}], ";", "\n", "\t", 
        RowBox[{"dt", "=", 
         RowBox[{"dt", " ", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               FractionBox["tol", 
                RowBox[{"2", " ", "e"}]], "]"}], ",", "0.3"}], "]"}], ",", 
            "2."}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dt", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"0.9", " ", "dt"}], ",", "dtmin"}], "]"}], ",", 
           "dtmax"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", "moms", "]"}], ">", 
           SuperscriptBox["10", "8"]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Crash \>\"", ",", 
             RowBox[{"100", " ", 
              RowBox[{"t", "/", "T"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Time\>\"", ",", 
         RowBox[{"100", 
          RowBox[{"t", "/", "T"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<\[Delta]t\>\"", ",", 
         RowBox[{"dt", "/", "dt0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Moments\>\"", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", "moms", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
    "\[IndentingNewLine]", "]"}], ";"}], "\n", 
 RowBox[{"Length", "[", "ts", "]"}]}], "Input",
 CellChangeTimes->{{3.794174186970871*^9, 3.794174197150276*^9}, {
   3.7941771989309187`*^9, 3.794177207262064*^9}, 3.7941772716149063`*^9, {
   3.7941797295984297`*^9, 3.794179740840107*^9}, {3.794179775936517*^9, 
   3.794179806586179*^9}, {3.794179864418756*^9, 3.794179886215808*^9}, {
   3.7941799388031073`*^9, 3.794179978434065*^9}, {3.79418013045798*^9, 
   3.794180130733644*^9}, {3.794180560373767*^9, 3.7941805617648907`*^9}, {
   3.794180718361479*^9, 3.794180721453149*^9}, {3.7941808122389507`*^9, 
   3.794180814428442*^9}, {3.794180913431634*^9, 3.794180915523314*^9}, {
   3.7941809615847387`*^9, 3.794180965807785*^9}, {3.7941810071089697`*^9, 
   3.7941810253270206`*^9}, {3.794181671979303*^9, 3.7941816735670013`*^9}, {
   3.794182091063905*^9, 3.794182095155199*^9}, {3.794185917510436*^9, 
   3.7941860767295628`*^9}, {3.7941861425838413`*^9, 3.794186231898076*^9}, {
   3.794186276771291*^9, 3.794186328883473*^9}, {3.794186380024803*^9, 
   3.794186380118731*^9}, {3.7941865148397827`*^9, 3.7941865427094603`*^9}, {
   3.7941868525612097`*^9, 3.794186853325341*^9}, {3.794188099515552*^9, 
   3.794188109552877*^9}, {3.794189102938743*^9, 3.794189110103857*^9}, {
   3.794189199144932*^9, 3.794189214895451*^9}, {3.794189295745318*^9, 
   3.794189295939543*^9}, {3.79418939758984*^9, 3.794189397844365*^9}, {
   3.79418945125112*^9, 3.794189451324849*^9}, {3.794189486954947*^9, 
   3.7941895399181013`*^9}, {3.794189628707733*^9, 3.794189628784711*^9}, {
   3.7941924605840273`*^9, 3.794192461278413*^9}, {3.7942365713437366`*^9, 
   3.794236574485615*^9}, {3.794237353480051*^9, 3.794237421245687*^9}, {
   3.7942374929995623`*^9, 3.794237493057646*^9}, {3.7942377080124397`*^9, 
   3.794237721344932*^9}, {3.7942378364015913`*^9, 3.794237854732192*^9}, {
   3.794238294916844*^9, 3.794238295179701*^9}, {3.7942385225177*^9, 
   3.7942385475539837`*^9}, {3.79423878959332*^9, 3.794238809247123*^9}, {
   3.794244225803732*^9, 3.794244228758559*^9}, {3.7942444407358637`*^9, 
   3.794244492446692*^9}, {3.794256695347455*^9, 3.794256732293747*^9}, {
   3.7942590983413343`*^9, 3.7942591589062*^9}, {3.7942615981396103`*^9, 
   3.794261598729648*^9}, {3.7942669925538063`*^9, 3.794266992949934*^9}, {
   3.7942738494094887`*^9, 3.794273849463243*^9}, {3.7945884882212687`*^9, 
   3.794588488412709*^9}, {3.794588817952826*^9, 3.7945888181958447`*^9}, {
   3.794589578818898*^9, 3.79458958089314*^9}, {3.794589649286747*^9, 
   3.794589650323215*^9}, {3.79459022548944*^9, 3.794590225530512*^9}, {
   3.794597338567836*^9, 3.794597344704014*^9}, {3.794599095266878*^9, 
   3.794599101632763*^9}, {3.794599929502659*^9, 3.794599964001646*^9}, {
   3.79460000062436*^9, 3.794600001029563*^9}, {3.794600081536697*^9, 
   3.794600081685184*^9}, {3.7946002207999783`*^9, 3.7946003458468313`*^9}, {
   3.794600399054578*^9, 3.794600414648344*^9}, {3.794600523637648*^9, 
   3.7946006002557087`*^9}, {3.7946009273437023`*^9, 3.794600935640629*^9}, {
   3.794604194563796*^9, 3.794604206694497*^9}, 3.794604309825384*^9, {
   3.794604378919283*^9, 3.794604389074686*^9}, {3.794604530301106*^9, 
   3.7946045522290916`*^9}, {3.794615332706232*^9, 3.794615343451846*^9}, {
   3.7946153909449387`*^9, 3.794615419178397*^9}, 3.794659008120645*^9, 
   3.79465938688447*^9, 3.794660120915856*^9, 3.794660381757999*^9, {
   3.7946607706347647`*^9, 3.794660771130342*^9}, {3.794661002851932*^9, 
   3.794661002909666*^9}, {3.794661155370102*^9, 3.794661226567041*^9}, {
   3.7946612664735413`*^9, 3.794661432527452*^9}, {3.794661552330917*^9, 
   3.79466159890788*^9}, 3.79466179381282*^9, 3.79466188963778*^9, {
   3.794661945493573*^9, 3.794661946074553*^9}, {3.794661978587738*^9, 
   3.79466199826621*^9}, {3.7946621342129087`*^9, 3.794662134335943*^9}, {
   3.794662480883327*^9, 3.794662482428589*^9}, {3.794662634156122*^9, 
   3.7946626347510843`*^9}, {3.794662758078573*^9, 3.794662781456808*^9}, {
   3.7946628244482927`*^9, 3.794662851521742*^9}, {3.794663003374064*^9, 
   3.794663037299979*^9}, {3.794663155305812*^9, 3.794663220687214*^9}, {
   3.7946639250874166`*^9, 3.79466394907085*^9}, {3.794664228626924*^9, 
   3.794664249919972*^9}, {3.794664740250807*^9, 3.794664768755185*^9}, {
   3.794757708686528*^9, 3.794757714440984*^9}, {3.7947577592035646`*^9, 
   3.794757796767456*^9}, {3.79475823399866*^9, 3.794758234277776*^9}, {
   3.794767013590838*^9, 3.794767014159861*^9}, 3.7947670552546577`*^9, {
   3.7947672776057663`*^9, 3.794767277788897*^9}, {3.794767483290607*^9, 
   3.794767490355509*^9}, {3.794767658756722*^9, 3.7947676590009604`*^9}, {
   3.794767706529201*^9, 3.794767707851009*^9}, {3.7947679369678583`*^9, 
   3.7947679391478863`*^9}, {3.794862963227519*^9, 3.794862964181424*^9}, {
   3.794863041264647*^9, 3.7948630602517443`*^9}, {3.794864971426031*^9, 
   3.794864974912578*^9}, {3.7948650177783957`*^9, 3.794865027751319*^9}, {
   3.794865083408434*^9, 3.794865120270941*^9}, {3.794865228153235*^9, 
   3.79486533846544*^9}, {3.7948655089940767`*^9, 3.794865535159256*^9}, {
   3.794865738359248*^9, 3.7948657815738688`*^9}, {3.794865875855524*^9, 
   3.79486587588923*^9}, {3.794866607655843*^9, 3.794866607795287*^9}, {
   3.79486697272139*^9, 3.794866975186054*^9}, {3.794867567794385*^9, 
   3.7948675812429533`*^9}, 3.794868733386566*^9, {3.794869310193693*^9, 
   3.794869313019773*^9}, {3.794869350799754*^9, 3.794869361673972*^9}, 
   3.794869522537257*^9, 3.7948701628260117`*^9, {3.794870361447075*^9, 
   3.794870367477882*^9}, 3.794873022707552*^9, {3.7948734886867723`*^9, 
   3.794873497103733*^9}, {3.794873531642859*^9, 3.794873542535681*^9}, {
   3.79487368340415*^9, 3.794873710814183*^9}, {3.7948737425199347`*^9, 
   3.794873782232746*^9}, {3.794873818222045*^9, 3.7948738304783287`*^9}, {
   3.794873864380621*^9, 3.794873902234313*^9}, {3.794873941854986*^9, 
   3.7948739610205708`*^9}, {3.794924162226119*^9, 3.7949241634226637`*^9}, {
   3.794941026404992*^9, 3.7949410271703568`*^9}, {3.794941369210229*^9, 
   3.794941370912702*^9}, {3.794948827075592*^9, 3.79494883408982*^9}, {
   3.794948880116927*^9, 3.794948896624692*^9}, {3.7949491045242567`*^9, 
   3.7949491183287354`*^9}, {3.79494940814676*^9, 3.794949426909422*^9}, {
   3.7949495438298597`*^9, 3.7949495453387957`*^9}, {3.794949638721278*^9, 
   3.794949641729526*^9}, {3.794949676525134*^9, 3.794949680384742*^9}, {
   3.795869265504798*^9, 3.795869266449019*^9}, {3.795880354534637*^9, 
   3.795880359101243*^9}, 3.795892116732954*^9, {3.79589228227183*^9, 
   3.7958923311668158`*^9}, {3.795893102727248*^9, 3.795893105722142*^9}, {
   3.7958937151070766`*^9, 3.7958937158901453`*^9}, {3.795893798300274*^9, 
   3.795893798798411*^9}, {3.795893950910541*^9, 3.795893951828144*^9}, {
   3.795894322445325*^9, 3.795894322495015*^9}, {3.795894359504119*^9, 
   3.7958943603500147`*^9}, {3.795956087045652*^9, 3.795956088592598*^9}, {
   3.795956171942878*^9, 3.795956172066002*^9}, {3.795956369008353*^9, 
   3.7959564124564743`*^9}, {3.795956748283978*^9, 3.795956749581205*^9}, {
   3.7959573640739307`*^9, 3.7959573642629213`*^9}, {3.7959582219957237`*^9, 
   3.79595822281841*^9}, {3.795958878799697*^9, 3.79595903119156*^9}, {
   3.795959165552734*^9, 3.795959166318103*^9}, {3.795959232201962*^9, 
   3.795959234934493*^9}, {3.7959597048050632`*^9, 3.7959597090404778`*^9}, {
   3.795960299451667*^9, 3.795960321741589*^9}, {3.79596054603607*^9, 
   3.795960550920969*^9}, {3.795962449497805*^9, 3.795962449830011*^9}, {
   3.795962527906303*^9, 3.795962528888002*^9}, {3.795962651941106*^9, 
   3.7959626539155703`*^9}, {3.795963099135641*^9, 3.795963099222003*^9}, {
   3.795963151638474*^9, 3.795963152229094*^9}, {3.7959635040801363`*^9, 
   3.795963504952957*^9}, {3.795963678716712*^9, 3.7959636800189953`*^9}, {
   3.79596531189795*^9, 3.7959653128713007`*^9}, {3.7959675387474823`*^9, 
   3.795967584265662*^9}, 3.795967680804927*^9, 3.795967885629434*^9, {
   3.795967980641532*^9, 3.7959679806997433`*^9}, {3.79596928038695*^9, 
   3.795969280490712*^9}, 3.795969726277224*^9, {3.795971582590497*^9, 
   3.795971584436707*^9}, {3.795972265241315*^9, 3.7959722654026003`*^9}, {
   3.796046482170642*^9, 3.796046508308292*^9}, {3.796046935632806*^9, 
   3.796046937233584*^9}, {3.796050962166662*^9, 3.796050962298785*^9}, {
   3.796051131220516*^9, 3.796051131313715*^9}, {3.7960511960172873`*^9, 
   3.796051202760619*^9}, 3.7960599616283484`*^9, 3.7960619899861507`*^9, {
   3.796065356490267*^9, 3.796065358794508*^9}, {3.796065594103491*^9, 
   3.7960656244055977`*^9}, {3.7960656980312967`*^9, 3.796065698121111*^9}, {
   3.796065991063222*^9, 3.796065991121241*^9}, {3.796068584253748*^9, 
   3.796068584346092*^9}, {3.796133129943244*^9, 3.796133188685677*^9}, {
   3.796133318607039*^9, 3.7961333604657793`*^9}, {3.796134473355768*^9, 
   3.796134640455614*^9}, {3.796135156477489*^9, 3.796135158137959*^9}, {
   3.7961355430611153`*^9, 3.796135544831987*^9}, {3.796136190289032*^9, 
   3.796136191402998*^9}, {3.7961371478949537`*^9, 3.79613715048512*^9}, {
   3.796140299807859*^9, 3.7961403480250177`*^9}, {3.796140441852051*^9, 
   3.796140458025929*^9}, {3.796140811963522*^9, 3.7961409008933773`*^9}, {
   3.796140944559122*^9, 3.7961409594897823`*^9}, {3.796141004520046*^9, 
   3.7961410556687737`*^9}, {3.796141162059544*^9, 3.79614119159575*^9}, {
   3.796141399131399*^9, 3.796141399647676*^9}, {3.796141430044847*^9, 
   3.796141442406683*^9}, {3.796141544787167*^9, 3.796141569639213*^9}, {
   3.796141608247685*^9, 3.796141719299901*^9}, {3.7961423900880127`*^9, 
   3.796142390144753*^9}, {3.796143286731765*^9, 3.796143286765615*^9}, {
   3.796143671538294*^9, 3.796143677133657*^9}, {3.796157692273095*^9, 
   3.796157714152191*^9}, {3.796157798775155*^9, 3.796157919751697*^9}, {
   3.7961579916387587`*^9, 3.796158042855936*^9}, {3.796158991858356*^9, 
   3.796158993713394*^9}, {3.796159080385138*^9, 3.796159084656128*^9}, {
   3.796159247991417*^9, 3.796159250016959*^9}, {3.7961601441134443`*^9, 
   3.7961602696261177`*^9}, {3.796160314549547*^9, 3.796160393997758*^9}, {
   3.796160561321476*^9, 3.796160571658897*^9}, {3.796160724986476*^9, 
   3.796160725937628*^9}, {3.796160801141815*^9, 3.796160801917719*^9}, {
   3.796162824033154*^9, 3.79616287189576*^9}, {3.796162922737852*^9, 
   3.796162923063149*^9}, {3.796162956576434*^9, 3.7961630210171003`*^9}, {
   3.79616306074621*^9, 3.796163063386455*^9}, {3.796163327966957*^9, 
   3.7961633293787193`*^9}, {3.796163477100358*^9, 3.796163481114702*^9}, {
   3.796163518738278*^9, 3.796163518781066*^9}, {3.796163943802657*^9, 
   3.796163944861732*^9}, {3.7961639900350847`*^9, 3.796163991393353*^9}, {
   3.796164322107822*^9, 3.7961643229769077`*^9}, {3.7962179588845177`*^9, 
   3.796217959328182*^9}, {3.7969530339672613`*^9, 3.796953080665395*^9}, {
   3.797001723930358*^9, 3.797001728049404*^9}, {3.797001847019432*^9, 
   3.797001848739729*^9}, {3.797002261656842*^9, 3.797002262117323*^9}, {
   3.7970046194301*^9, 3.797004620632745*^9}, {3.7970048417559357`*^9, 
   3.797004850631652*^9}, {3.79700502282235*^9, 3.797005045654664*^9}, {
   3.797005451818266*^9, 3.797005465901634*^9}, {3.797005610997965*^9, 
   3.797005611624284*^9}, {3.7970058757024107`*^9, 3.797005876168145*^9}, {
   3.797006068902834*^9, 3.7970060691476383`*^9}, {3.797006166624463*^9, 
   3.797006180491088*^9}, {3.797006222849859*^9, 3.79700622292583*^9}, {
   3.797006528561069*^9, 3.797006528637576*^9}, {3.797006609808967*^9, 
   3.797006609885734*^9}, {3.797006687220378*^9, 3.79700668954745*^9}, {
   3.797007459261483*^9, 3.7970074728780613`*^9}, {3.7970076391908503`*^9, 
   3.797007640369692*^9}, {3.7970078496380463`*^9, 3.797007849770466*^9}, {
   3.7970085450237007`*^9, 3.79700854643882*^9}, {3.797009036173983*^9, 
   3.797009036305735*^9}, {3.7970092713049107`*^9, 3.7970092794661207`*^9}, {
   3.7970095894479313`*^9, 3.7970096139240627`*^9}, {3.7970096715740347`*^9, 
   3.797009689525958*^9}, {3.797009844352106*^9, 3.7970098444396343`*^9}, 
   3.79701638491188*^9, {3.797016920361677*^9, 3.797016924083476*^9}, {
   3.7970170615485973`*^9, 3.797017061627021*^9}, {3.797017410770343*^9, 
   3.7970174121359987`*^9}, {3.7970186450806217`*^9, 
   3.7970186451783257`*^9}, {3.797018919034841*^9, 3.79701891913484*^9}, {
   3.797019234007182*^9, 3.797019238370034*^9}, {3.797019372704047*^9, 
   3.7970193727514887`*^9}, {3.797019595937375*^9, 3.797019595978698*^9}, {
   3.797019837612607*^9, 3.7970198376888103`*^9}, {3.797087320084072*^9, 
   3.7970873330912437`*^9}, {3.797088690304666*^9, 3.797088694163563*^9}, {
   3.797173725831724*^9, 3.797173726857332*^9}, {3.797173826999206*^9, 
   3.797173844984662*^9}, {3.797251666464381*^9, 3.7972516774811373`*^9}, {
   3.7972519138493834`*^9, 3.797251923498672*^9}, {3.797252102986473*^9, 
   3.797252103064458*^9}, {3.7972528002842207`*^9, 3.797252844585288*^9}, {
   3.797253051941798*^9, 3.797253052022962*^9}, {3.797255590542214*^9, 
   3.797255590591095*^9}, {3.79725998480826*^9, 3.797260049815495*^9}, 
   3.7972601025170813`*^9, {3.797260279866165*^9, 3.7972603043313627`*^9}, {
   3.797260356674327*^9, 3.797260429895702*^9}, {3.7972606255579348`*^9, 
   3.797260627122353*^9}, {3.7972609613178596`*^9, 3.7972609650100327`*^9}, {
   3.7972610311877537`*^9, 3.797261031953979*^9}, {3.797261146825385*^9, 
   3.797261155919489*^9}, {3.797263705955625*^9, 3.797263705982328*^9}, {
   3.797263800417768*^9, 3.797263800474238*^9}, {3.797263833843704*^9, 
   3.797263834035536*^9}, {3.79726414536353*^9, 3.7972641458069*^9}, {
   3.797264219731526*^9, 3.797264221141118*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"2f30d941-a7dd-495f-84a4-f416dbfae861"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.545825155715281*^9, {3.797018625196801*^9, 3.7970186408467827`*^9}, 
   3.797018679850884*^9, 3.797018726417667*^9, 3.797018774085721*^9, 
   3.797018832051701*^9, 3.797018973435754*^9, 3.797019215009489*^9, 
   3.7970193059406652`*^9, 3.797019573777893*^9, 3.797019620848974*^9, 
   3.797019710730126*^9, 3.797019744106983*^9, 3.7970198341862593`*^9, 
   3.797019869425812*^9, 3.797020294304566*^9, 3.7970207691838293`*^9, 
   3.797020936146125*^9, 3.797020973370885*^9, 3.797021219842166*^9, {
   3.797087299079495*^9, 3.7970873275427027`*^9}, 3.79708736714176*^9, 
   3.797088720677549*^9, 3.797088836684057*^9, 3.797091068663424*^9, 
   3.797091177292675*^9, 3.797091293121498*^9, 3.7970913772761717`*^9, 
   3.7970914478234453`*^9, 3.797173720753631*^9, 3.797173807080078*^9, 
   3.797173885633142*^9, 3.797173946627491*^9, 3.7972516482071*^9, 
   3.7972516975597486`*^9, 3.7972519105635357`*^9, 3.797252106689436*^9, 
   3.7972528836700068`*^9, 3.797253093768134*^9, 3.797254749312316*^9, 
   3.797255624845113*^9, 3.797260174172529*^9, 3.7972602442013597`*^9, 
   3.7972605387109423`*^9, {3.797260592068184*^9, 3.7972606281797867`*^9}, 
   3.797260928971093*^9, {3.7972609657486963`*^9, 3.797260986939803*^9}, 
   3.797261041806896*^9, 3.797261164420102*^9, 3.7972612985307903`*^9, 
   3.797262888707349*^9, 3.797263102120399*^9, 3.797263180473258*^9, 
   3.7972634826137457`*^9, 3.797263769238968*^9, 3.797263813315366*^9, 
   3.797263868566803*^9, 3.797264002774033*^9, 3.797264381371634*^9, 
   3.797264437155443*^9, 3.797264570550363*^9, 3.797264635875218*^9, 
   3.79726500571338*^9, 3.79726514886425*^9, 3.797265351801258*^9, 
   3.7972665433113623`*^9, 3.797266595590479*^9, 3.797266688686494*^9, 
   3.7972673874021273`*^9, 3.797267447684293*^9, 3.797267540085421*^9, 
   3.797267650571321*^9, 3.797268703022965*^9, 3.797268829816792*^9, 
   3.7972689367331057`*^9, 3.797269995405705*^9, 3.797277461160698*^9, 
   3.797282633281084*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"4e57c3c6-1aee-47a0-b1b4-c26489e40813"],

Cell[BoxData["627"], "Output",
 CellChangeTimes->{
  3.545825155715281*^9, {3.797018625196801*^9, 3.7970186408467827`*^9}, 
   3.797018679850884*^9, 3.797018726417667*^9, 3.797018774085721*^9, 
   3.797018832051701*^9, 3.797018973435754*^9, 3.797019215009489*^9, 
   3.7970193059406652`*^9, 3.797019573777893*^9, 3.797019620848974*^9, 
   3.797019710730126*^9, 3.797019744106983*^9, 3.7970198341862593`*^9, 
   3.797019869425812*^9, 3.797020294304566*^9, 3.7970207691838293`*^9, 
   3.797020936146125*^9, 3.797020973370885*^9, 3.797021219842166*^9, {
   3.797087299079495*^9, 3.7970873275427027`*^9}, 3.79708736714176*^9, 
   3.797088720677549*^9, 3.797088836684057*^9, 3.797091068663424*^9, 
   3.797091177292675*^9, 3.797091293121498*^9, 3.7970913772761717`*^9, 
   3.7970914478234453`*^9, 3.797173720753631*^9, 3.797173807080078*^9, 
   3.797173885633142*^9, 3.797173946627491*^9, 3.7972516482071*^9, 
   3.7972516975597486`*^9, 3.7972519105635357`*^9, 3.797252106689436*^9, 
   3.7972528836700068`*^9, 3.797253093768134*^9, 3.797254749312316*^9, 
   3.797255624845113*^9, 3.797260174172529*^9, 3.7972602442013597`*^9, 
   3.7972605387109423`*^9, {3.797260592068184*^9, 3.7972606281797867`*^9}, 
   3.797260928971093*^9, {3.7972609657486963`*^9, 3.797260986939803*^9}, 
   3.797261041806896*^9, 3.797261164420102*^9, 3.7972612985307903`*^9, 
   3.797262888707349*^9, 3.797263102120399*^9, 3.797263180473258*^9, 
   3.7972634826137457`*^9, 3.797263769238968*^9, 3.797263813315366*^9, 
   3.797263868566803*^9, 3.797264002774033*^9, 3.797264381371634*^9, 
   3.797264437155443*^9, 3.797264570550363*^9, 3.797264635875218*^9, 
   3.79726500571338*^9, 3.79726514886425*^9, 3.797265351801258*^9, 
   3.7972665433113623`*^9, 3.797266595590479*^9, 3.797266688686494*^9, 
   3.7972673874021273`*^9, 3.797267447684293*^9, 3.797267540085421*^9, 
   3.797267650571321*^9, 3.797268703022965*^9, 3.797268829816792*^9, 
   3.7972689367331057`*^9, 3.797269995405705*^9, 3.797277461160698*^9, 
   3.797282633283184*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"d401834f-8386-404c-956c-202e763de4bc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myn", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plottingfac", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"myts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ts", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "abscissa", "]"}], ",", 
       RowBox[{"Floor", "[", 
        FractionBox[
         RowBox[{"Length", "[", "abscissa", "]"}], "myn"], "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myabscissa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"abscissa", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "abscissa", "]"}], ",", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"Length", "[", "abscissa", "]"}], "/", 
         RowBox[{"N", "[", "myn", "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdat", "=", 
   RowBox[{"myabscissa", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ydat", "=", 
   RowBox[{"myabscissa", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Max", "[", "xdat", "]"}], ">", "0"}], ",", 
     RowBox[{"1.2", " ", 
      RowBox[{"Max", "[", "xdat", "]"}]}], ",", 
     RowBox[{"0.8", " ", 
      RowBox[{"Max", "[", "xdat", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmin", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Min", "[", "xdat", "]"}], "<", "0"}], ",", 
     RowBox[{"1.2", " ", 
      RowBox[{"Min", "[", "xdat", "]"}]}], ",", 
     RowBox[{"0.8", " ", 
      RowBox[{"Min", "[", "xdat", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ymax", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Max", "[", "ydat", "]"}], ">", "0"}], ",", 
     RowBox[{"1.2", " ", 
      RowBox[{"Max", "[", "ydat", "]"}]}], ",", 
     RowBox[{"0.8", " ", 
      RowBox[{"Max", "[", "xdat", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ymin", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Min", "[", "ydat", "]"}], "<", "0"}], ",", 
     RowBox[{"1.2", 
      RowBox[{"Min", "[", "ydat", "]"}]}], ",", 
     RowBox[{"0.8", " ", 
      RowBox[{"Min", "[", "ydat", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListAnimate", "[", 
  RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"myabscissa", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}]}], "]"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"Length", "[", "myabscissa", "]"}], "/", "plottingfac"}]}], 
     "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.795959190042141*^9, 3.795959197269055*^9}, {
   3.795959263399991*^9, 3.7959593651341*^9}, {3.795959400239666*^9, 
   3.7959594169984093`*^9}, {3.795959517834207*^9, 3.7959595191565104`*^9}, {
   3.7959595520335197`*^9, 3.79595955208011*^9}, {3.795962613160328*^9, 
   3.7959626270393133`*^9}, {3.795964792317004*^9, 3.79596479977559*^9}, {
   3.795964897210252*^9, 3.79596494256489*^9}, {3.795965569036049*^9, 
   3.79596560901359*^9}, {3.795965706193819*^9, 3.7959657069008408`*^9}, {
   3.796061964753973*^9, 3.796061966208783*^9}, {3.796064392780137*^9, 
   3.796064410237525*^9}, {3.796068649933022*^9, 3.796068650168891*^9}, {
   3.7961344163893003`*^9, 3.796134416870776*^9}, {3.796135303056684*^9, 
   3.796135311481228*^9}, 3.796137118255693*^9, {3.796141926372909*^9, 
   3.7961419267040453`*^9}, {3.796220426235853*^9, 3.796220426338541*^9}, {
   3.797005078888215*^9, 3.797005102826466*^9}, {3.797005144035974*^9, 
   3.797005233731489*^9}, {3.7970053081426563`*^9, 3.797005314044879*^9}, {
   3.797005570159114*^9, 3.797005580630971*^9}, {3.797006311701432*^9, 
   3.7970063256272707`*^9}, {3.797007690681877*^9, 3.797007690746213*^9}, {
   3.797255223911982*^9, 3.797255232418738*^9}, {3.797255577435564*^9, 
   3.7972555787647133`*^9}, {3.797267260581646*^9, 3.7972672672260923`*^9}, {
   3.797267327898458*^9, 3.797267344760751*^9}, {3.797267495834546*^9, 
   3.797267498922161*^9}},
 CellLabel->
  "In[7014]:=",ExpressionUUID->"17531eeb-e1bf-4359-bc45-8b924a3538a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"ks", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "10"}], "&&", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"ks", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "0"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"ts", ",", 
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"ks", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "moms", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", "plots"}], "Input",
 CellChangeTimes->{{3.79112848283429*^9, 3.7911285377820463`*^9}, {
   3.791128653333568*^9, 3.791128663757998*^9}, {3.791129476746401*^9, 
   3.791129484096518*^9}, {3.791129530675394*^9, 3.791129554054864*^9}, {
   3.791129709495949*^9, 3.791129715189269*^9}, {3.7911297735140047`*^9, 
   3.791129784662198*^9}, {3.7913007624507637`*^9, 3.791300818286351*^9}, {
   3.791300912610611*^9, 3.791300935588625*^9}, {3.791301041821347*^9, 
   3.791301056542822*^9}, {3.79131628973518*^9, 3.791316292149864*^9}, {
   3.791573864400901*^9, 3.7915738936302223`*^9}, {3.794164950106798*^9, 
   3.794164982136808*^9}, {3.794165116808003*^9, 3.794165128895836*^9}, {
   3.794165306973666*^9, 3.794165326044292*^9}, {3.794186711346985*^9, 
   3.794186716134775*^9}, {3.794189767636405*^9, 3.794189783286042*^9}, {
   3.794235168522629*^9, 3.7942351717134237`*^9}, {3.794238023663443*^9, 
   3.794238025987936*^9}, {3.794273873472445*^9, 3.794273875536119*^9}, {
   3.794595503131254*^9, 3.79459552055606*^9}, {3.794660609655254*^9, 
   3.794660616135635*^9}, {3.794662097961788*^9, 3.794662099050969*^9}, 
   3.7946621924602613`*^9, {3.7948730653449*^9, 3.794873067738141*^9}, {
   3.7959573472629623`*^9, 3.7959573489924307`*^9}, 3.796061044281122*^9},
 CellLabel->
  "In[7230]:=",ExpressionUUID->"81b4665b-e84d-4dbf-a101-9ee6add4a25f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "with", " ", "Monte", " ", "Carlo"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ncases", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cases", "=", 
     RowBox[{"RandomVariate", "[", 
      RowBox[{"RRdPDF", ",", "Ncases"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"type", "=", "\"\<nonlinear\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "t", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"type", "\[Equal]", "\"\<linear\>\""}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"\[Beta]", "=", 
        FractionBox["2", "Rey"]}], ";", 
       RowBox[{"\[Omega]2", "=", " ", 
        RowBox[{"2", " ", "\[Gamma]", " ", "Ca"}]}], ";", "\n", "\t", 
       RowBox[{"myr", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "t", "]"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", "''"}], "[", "t", "]"}], " ", "\[Equal]", 
                   " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Beta]", " ", 
                    RowBox[{
                    RowBox[{"r", "'"}], "[", "t", "]"}]}], "-", 
                    RowBox[{"\[Omega]2", " ", 
                    RowBox[{"r", "[", "t", "]"}]}], "-", 
                    RowBox[{"Cp", "[", "t", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"r", "[", "0", "]"}], "\[Equal]", 
                   RowBox[{"cases", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", "'"}], "[", "0", "]"}], "\[Equal]", 
                   RowBox[{"cases", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"r", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "//", 
              "First"}], "//", "First"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ncases"}], "}"}]}], "]"}]}], ";"}], 
      "\n", ",", "\n", "\t", 
      RowBox[{
       RowBox[{"myr", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "t", "]"}], "/.", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", "t", "]"}], 
                    RowBox[{
                    RowBox[{"r", "''"}], "[", "t", "]"}]}], "+", 
                    RowBox[{
                    FractionBox["3", "2"], 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{"r", "'"}], "[", "t", "]"}], "2"]}]}], " ", 
                   "\[Equal]", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    FractionBox["1", 
                    RowBox[{"r", "[", "t", "]"}]], ")"}], 
                    RowBox[{"3", " ", "\[Gamma]"}]], "-", 
                    RowBox[{"Cp", "[", "t", "]"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"r", "[", "0", "]"}], "\[Equal]", 
                   RowBox[{"cases", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"r", "'"}], "[", "0", "]"}], "\[Equal]", 
                   RowBox[{"cases", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"r", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "//", 
              "First"}], "//", "First"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "Ncases"}], "}"}]}], "]"}]}], ";"}]}], 
     "\n", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mydr", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"myr", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "t"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Ncases"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Nt", "=", "100"}], ";", 
    RowBox[{"ts2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "T", ",", 
         RowBox[{"T", "/", "Nt"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ts2", "=", "myts"}], ";", 
    RowBox[{"Nt", "=", 
     RowBox[{"Length", "[", "ts2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"myr", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"t", "\[Rule]", 
              RowBox[{"ts2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mydr", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "/.", 
            RowBox[{"{", 
             RowBox[{"t", "\[Rule]", 
              RowBox[{"ts2", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "Ncases"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mcmoms", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Moment", "[", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ks", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Nt"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "ks", "]"}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"mcmomssp", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ts2", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Moment", "[", 
            RowBox[{
             RowBox[{"P", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"ksp", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "Nt"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "ksp", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.794254591308536*^9, 3.794254656896716*^9}, {
   3.794254689953506*^9, 3.7942547153686*^9}, {3.794255247408787*^9, 
   3.794255280862814*^9}, {3.794255368675068*^9, 3.794255390359194*^9}, {
   3.795892264775606*^9, 3.795892271366785*^9}, {3.7959615919757013`*^9, 
   3.7959616095715237`*^9}, {3.795961639756922*^9, 3.79596165340667*^9}, {
   3.795964987520872*^9, 3.795964993856283*^9}, 3.79596542992511*^9, 
   3.795965698605492*^9, 3.796051300879305*^9, {3.796217875975486*^9, 
   3.7962179518131113`*^9}, 3.796217991916256*^9, {3.7962189696677637`*^9, 
   3.796218983281699*^9}, {3.796219052354475*^9, 3.79621907991696*^9}, {
   3.7962192918994217`*^9, 3.796219292903882*^9}, {3.796401825577257*^9, 
   3.796401863319171*^9}, {3.7964019015582113`*^9, 3.796401920951028*^9}, {
   3.7964194674510107`*^9, 3.796419469750399*^9}, {3.796431849991064*^9, 
   3.796431895624236*^9}, {3.796433119097763*^9, 3.796433134047597*^9}, 
   3.7964407590141373`*^9, {3.7964840692304564`*^9, 3.7964840736771517`*^9}, 
   3.796484258344521*^9, {3.796484574614359*^9, 3.796484593074131*^9}, {
   3.796485800418646*^9, 3.796485801747245*^9}, {3.796486049421289*^9, 
   3.796486049571704*^9}, {3.796486364155231*^9, 3.796486364355044*^9}, 
   3.7964867098282957`*^9, {3.796487082004285*^9, 3.796487085732728*^9}, {
   3.79648717672499*^9, 3.79648717752042*^9}, {3.796488833317131*^9, 
   3.796488833635564*^9}, 3.796489682544044*^9, 3.796490008071986*^9, {
   3.7965995487673473`*^9, 3.796599550036045*^9}, {3.796599586158977*^9, 
   3.796599586294835*^9}, {3.796600060660357*^9, 3.796600060830915*^9}, 
   3.796600125290475*^9, {3.797006879609373*^9, 3.797006889969242*^9}, 
   3.797016640300632*^9, 3.797017453742651*^9, {3.797087398026607*^9, 
   3.79708740014585*^9}, {3.797088940886107*^9, 3.7970889434002657`*^9}, {
   3.797091099262598*^9, 3.797091099492393*^9}, {3.797091158363986*^9, 
   3.797091158436368*^9}, {3.79725176477562*^9, 3.797251785501442*^9}, {
   3.797252126300013*^9, 3.797252128345603*^9}, {3.797252925821175*^9, 
   3.797252948212594*^9}, 3.797253132054027*^9, {3.797253446710162*^9, 
   3.797253446775425*^9}, 3.797254753506679*^9, 3.797254839170587*^9, {
   3.7972550177500343`*^9, 3.797255020955278*^9}, 3.7972552107270117`*^9, {
   3.797255255235858*^9, 3.797255256136364*^9}, {3.79726290714811*^9, 
   3.79726292400301*^9}, {3.797263255655321*^9, 3.797263255720201*^9}, {
   3.79726364132358*^9, 3.797263641384852*^9}, {3.7972647128973713`*^9, 
   3.797264712949037*^9}, {3.797264938428896*^9, 3.797264938505169*^9}, 
   3.797266866549129*^9, 3.797267255470008*^9},
 CellLabel->
  "In[7028]:=",ExpressionUUID->"fa13c866-d31a-4446-a4ce-d8c0724e29b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plts", "=", 
   RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DensityHistogram", "[", 
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ymin", ",", "ymax"}], "}"}], ",", "All"}], "}"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"myabscissa", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}]}], "]"}]}], 
      "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "[", "P", "]"}], "/", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vid", "=", 
  RowBox[{"ListAnimate", "[", "plts", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7959645454608793`*^9, 3.7959647451346617`*^9}, {
   3.7959651209659863`*^9, 3.795965173754465*^9}, {3.795965488513041*^9, 
   3.7959655369635773`*^9}, {3.795965624601165*^9, 3.795965634796324*^9}, {
   3.795971722880128*^9, 3.795971724644668*^9}, {3.795971918634676*^9, 
   3.795971945210333*^9}, {3.796218408512011*^9, 3.7962184106177807`*^9}, {
   3.797007244049437*^9, 3.797007248435988*^9}, {3.797017457432376*^9, 
   3.797017458425007*^9}, 3.79701934430107*^9, {3.797020320905272*^9, 
   3.797020321720131*^9}, {3.7972553059302473`*^9, 3.797255307184347*^9}, 
   3.7972555811164722`*^9, 3.797263087082611*^9},
 CellLabel->
  "In[5947]:=",ExpressionUUID->"ccbba98e-48eb-4e7d-b86b-4e6fe8197944"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<~/Desktop/movie.avi\>\"", ",", "vid"}], "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.545825155715281*^9, {3.797017721591584*^9, 3.797017737176602*^9}, {
   3.7970889259789143`*^9, 3.7970889266749268`*^9}, {3.797089512910419*^9, 
   3.797089552851695*^9}, 3.797263518611594*^9},
 CellLabel->
  "In[6010]:=",ExpressionUUID->"91388fa3-7d20-4eb5-ad91-e3188457b7ba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"ks", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "<", "10"}], "&&", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"ks", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "0"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"plots", ",", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"ts", ",", 
              RowBox[{"sol", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
           
           RowBox[{"mcmoms", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"ks", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<t\>\"", ",", "\"\<Moment\>\""}], "}"}]}]}], "]"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "moms", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"plots", "\n"}], "\n", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"plots", ",", 
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"ts", ",", 
            RowBox[{"spsol", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"mcmomssp", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"ksp", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<t\>\"", ",", "\"\<Moment\>\""}], "}"}]}]}], "]"}]}], 
    "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "momsp", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", "plots"}], "Input",
 CellChangeTimes->{{3.79639331813057*^9, 3.796393327763133*^9}, {
  3.797087466795115*^9, 3.797087505703912*^9}, {3.797174643108384*^9, 
  3.797174645363503*^9}, {3.79725297810946*^9, 3.797253037113826*^9}},
 CellLabel->
  "In[7039]:=",ExpressionUUID->"3e6c72f2-7552-486a-be1b-b14a06e33217"]
}, Open  ]]
},
WindowSize->{1280, 1395},
WindowMargins->{{Automatic, 0}, {Automatic, -390}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Dimad.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 7646, 106, 62, "Input",ExpressionUUID->"31e5366b-cc42-472f-b3ec-a01bd110541e"],
Cell[8229, 130, 393, 10, 41, "Input",ExpressionUUID->"5358c7e2-7e38-471c-83ae-8ed81170c2db"],
Cell[8625, 142, 345, 9, 41, "Input",ExpressionUUID->"07b0e591-28cd-4bf4-965f-78d4aedbee84"],
Cell[8973, 153, 46612, 983, 3003, "Input",ExpressionUUID->"14ef2037-6e1d-4aef-8e01-4b3a06744e68"],
Cell[55588, 1138, 19644, 352, 832, "Input",ExpressionUUID->"2f30d941-a7dd-495f-84a4-f416dbfae861"],
Cell[75235, 1492, 2090, 30, 39, "Output",ExpressionUUID->"4e57c3c6-1aee-47a0-b1b4-c26489e40813"],
Cell[77328, 1524, 2085, 30, 39, "Output",ExpressionUUID->"d401834f-8386-404c-956c-202e763de4bc"],
Cell[79416, 1556, 4960, 130, 318, "Input",ExpressionUUID->"17531eeb-e1bf-4359-bc45-8b924a3538a9"],
Cell[84379, 1688, 2651, 56, 167, "Input",ExpressionUUID->"81b4665b-e84d-4dbf-a101-9ee6add4a25f"],
Cell[87033, 1746, 11082, 260, 863, "Input",ExpressionUUID->"fa13c866-d31a-4446-a4ce-d8c0724e29b6"],
Cell[98118, 2008, 2115, 49, 146, "Input",ExpressionUUID->"ccbba98e-48eb-4e7d-b86b-4e6fe8197944"],
Cell[100236, 2059, 440, 10, 41, "Input",ExpressionUUID->"91388fa3-7d20-4eb5-ad91-e3188457b7ba"],
Cell[100679, 2071, 3095, 83, 335, "Input",ExpressionUUID->"3e6c72f2-7552-486a-be1b-b14a06e33217"]
}, Open  ]]
}
]
*)

